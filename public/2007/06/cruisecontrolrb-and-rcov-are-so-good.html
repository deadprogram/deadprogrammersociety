<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CruiseControl.rb and RCov Are SO Good Together - Dead Programmer SOciety</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="/favicon.png">
  <link rel="canonical" href="/2007/06/cruisecontrolrb-and-rcov-are-so-good.html" />

  
  
  <link rel="stylesheet" href="/css/style.min.6b89cc86c0b843a772cdd6c6a8b7e11c2116c7933f6163d2ef225a87e1d2c121.css">
  

  
    
    <meta property="og:title" content="CruiseControl.rb and RCov Are SO Good Together"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="/2007/06/cruisecontrolrb-and-rcov-are-so-good.html"/>
    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@deadprogram"/>
    <meta name="twitter:creator" content="@deadprogram"/>
  

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet"> 
</head>




<body class='page frame page-blog-single'>
  <div id="menu-main-mobile" class="menu-main-mobile">
    <ul class="menu">
        
        
            
                <li class="menu-item-home">
                    <a href="/">Home</a>
                </li>
            
        
            
                <li class="menu-item-blog">
                    <a href="/posts/">Blog</a>
                </li>
            
        
            
                <li class="menu-item-about">
                    <a href="/about/">About</a>
                </li>
            
        
            
                <li class="menu-item-tags">
                    <a href="/tags/">Tags</a>
                </li>
            
        
    </ul>
</div>
  <div id="wrapper" class="wrapper">
    <div class='header'>
  <a class="header-logo" href="/">Dead Programmer SOciety</a>
  <div class="menu-main">
    <ul>
      
      
      
      
      <li class="menu-item-home ">
        <a href="/">
          
          <span>Home</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-blog ">
        <a href="/posts/">
          
          <span>Blog</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-about ">
        <a href="/about/">
          
          <span>About</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-tags ">
        <a href="/tags/">
          
          <span>Tags</span>
        </a>
      </li>
      
    </ul>
  </div>
  <div id="toggle-menu-main-mobile" class="hamburger-trigger">
    <button class="hamburger">Menu</button>
  </div>
</div>
    
  <div class="blog">
    
    <div class="intro">
      <h1>CruiseControl.rb and RCov Are SO Good Together<span class="dot">.</span></h1>
      
    </div>
    <div class="content">
      <p><a href="http://www.easybuenosairescity.com/fotos/tango2.jpg"><img src="http://www.easybuenosairescity.com/fotos/tango2.jpg" alt=""></a>I spent a bit of time this morning getting <a href="http://cruisecontrolrb.thoughtworks.com/">CruiseControl.rb</a> and <a href="http://eigenclass.org/hiki.rb?rcov">RCov</a> working together for a new client&rsquo;s fairly LARGE Ruby on Rails (70+ models, 40+ controllers) project. If you are not familiar with CruiseControl.rb, it is the Ruby based continuous integration tool from <a href="http://www.thoughtworks.com/">ThoughtWorks</a>. RCov, on the other hand, is a very well known code coverage tool for Ruby. The implementation was incredibly simple, but finding the information on how to get the two working together required a perusal of the CruiseControl.rb code itself.</p>
<p>First of all, you will need to install the <a href="http://blog.codahale.com/2006/05/26/rails-plugin-rails_rcov">rails_rcov</a> plugin. This useful plugin allows you to really easily run RCov using rake, and is essential to simple RCov integration with your CruiseControl.rb builds. You can install rails_rcov like this:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">  
./script/plugin install http://svn.codahale.com/rails\_rcov  

</code></pre></div><p>Use the &ldquo;-x&rdquo; option if you want to use an svn:external link to the latest version of the plugin. I personally don&rsquo;t like to do that&hellip;I want control over when the software I am using gets updated, thanks.</p>
<p>Once the plugin is installed into your project you have some useful rake tasks like this one:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">  
\# sort by coverage  
rake test:units:rcov RCOV\_PARAMS=&#34;--sort=coverage&#34;  

</code></pre></div><p>Now you are ready for the final bit, which is adding a &ldquo;cruise.rake&rdquo; task to the &ldquo;lib/tasks&rdquo; directory of your Ruby on Rails project. The task should have something like this, which was lifted verbatim from the CruiseControl.rb build of CruiseControl.rb itself (that all sounds kinda twisted, but it is cool):</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">  
desc &#39;Continuous build target&#39;  
task :cruise do  
  out = ENV\[&#39;CC\_BUILD\_ARTIFACTS&#39;\]  
  mkdir\_p out unless File.directory? out if out  
  
  ENV\[&#39;SHOW\_ONLY&#39;\] = &#39;models,lib,helpers&#39;  
  Rake::Task\[&#34;test:units:rcov&#34;\].invoke  
  mv &#39;coverage/units&#39;, &#34;#{out}/unit test coverage&#34; if out  
    
  ENV\[&#39;SHOW\_ONLY&#39;\] = &#39;controllers&#39;  
  Rake::Task\[&#34;test:functionals:rcov&#34;\].invoke  
  mv &#39;coverage/functionals&#39;, &#34;#{out}/functional test coverage&#34; if out  
    
  Rake::Task\[&#34;test:integration&#34;\].invoke  
end  

</code></pre></div><p>That&rsquo;s it. Now you have incredible code coverage goodness right within your build. You can even browse the source within the browser window of the CruiseControl.rb dashboard and see which lines of code were covered by your tests, and which were not&hellip;</p>
<p>So if you have a Ruby on Rails project, with a project team of greater than 1 developer, you had better start using CruiseControl.rb. It is too easy, and the payoff of doing continuous integration is huge!</p>

    </div>
  </div>

    <div class="footer">
  
  <div class="footer-social">
    
      <span class="social-icon social-icon-twitter">
        <a href="https://twitter.com/deadprogram" title="twitter" target="_blank" rel="noopener">
          <img src="/images/social/twitter.svg" width="24" height="24" alt="twitter"/>
        </a>
      </span>
    
      <span class="social-icon social-icon-github">
        <a href="https://github.com/deadprogram" title="github" target="_blank" rel="noopener">
          <img src="/images/social/github.svg" width="24" height="24" alt="github"/>
        </a>
      </span>
    
      <span class="social-icon social-icon-linkedin">
        <a href="https://www.linkedin.com/in/deadprogram/" title="linkedin" target="_blank" rel="noopener">
          <img src="/images/social/linkedin.svg" width="24" height="24" alt="linkedin"/>
        </a>
      </span>
    
  </div>
  
</div>
  </div>

  

  

  
  <script type="text/javascript" src="/js/bundle.min.575671c6da23c3563d465f9cfa3d2857fc0239531a2e8ea1fb6812017653b4d7.js"></script>
  

  
  

  
  
  
    
  

  


</body>
</html>